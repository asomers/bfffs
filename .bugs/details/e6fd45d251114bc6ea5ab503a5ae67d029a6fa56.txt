# Lines starting with '#' and sections without content
# are not displayed by a call to 'details'
#
[paths]
# Paths related to this bug.
# suggested format: REPO_PATH:LINENUMBERS


[details]
The FS Torture test has revealed a "attempt to subtract with overflow"
during Tree::range_delete_pass2, as invoked during cleaning.


[expected]
# The expected result


[actual]
Partial stack trace:
   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace
   1: std::sys_common::backtrace::print
   2: std::panicking::default_hook::{{closure}}
   3: std::panicking::default_hook
   4: std::panicking::rust_panic_with_hook
   5: std::panicking::continue_panic_fmt
   6: rust_begin_unwind
   7: core::panicking::panic_fmt
   8: core::panicking::panic
   9: <bfffs::common::tree::Tree<A, D, K, V>>::range_delete_pass2_r::{{closure}}
             at ./src/common/tree/mod.rs:1607


[reproduce]
Regression test added.  First, disable the timed syncer by setting its
duration in Syncer::run to a large value.  Then, run the
common::fs::torture::range_delete_pass2_subtract_with_overflow test


[comments]
# Comments and updates - leave your name
# Lines starting with '#' and sections without content
# are not displayed by a call to 'details'
#
[paths]
# Paths related to this bug.
# suggested format: REPO_PATH:LINENUMBERS


[details]
The FS Torture test has revealed a "attempt to subtract with overflow"
during Tree::range_delete_pass2, as invoked during cleaning.


[expected]
# The expected result


[actual]
Partial stack trace:
   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace
   1: std::sys_common::backtrace::print
   2: std::panicking::default_hook::{{closure}}
   3: std::panicking::default_hook
   4: std::panicking::rust_panic_with_hook
   5: std::panicking::continue_panic_fmt
   6: rust_begin_unwind
   7: core::panicking::panic_fmt
   8: core::panicking::panic
   9: <bfffs::common::tree::Tree<A, D, K, V>>::range_delete_pass2_r::{{closure}}
             at ./src/common/tree/mod.rs:1607


[reproduce]
Regression test added.  First, disable the timed syncer by setting its
duration in Syncer::run to a large value.  Then, run the
common::fs::torture::range_delete_pass2_subtract_with_overflow test


[comments]
# Comments and updates - leave your name
